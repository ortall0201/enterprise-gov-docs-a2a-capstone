# ğŸš€ Render Deployment - Quick Start

## What Was Fixed

âœ… **Removed heavy dependencies** that caused build timeouts:
- `crewai>=0.157.0` (not used) - REMOVED
- `crewai-tools>=0.75.0` (not used) - REMOVED
- `google-cloud-aiplatform>=1.70.0` (not used) - REMOVED

âœ… **Build time**: From 15+ minutes â†’ **2-3 minutes**

---

## Deploy in 5 Steps

### 1ï¸âƒ£ Push to GitHub
```bash
cd docs-translator-a2a
git add .
git commit -m "Optimized for Render deployment"
git push origin main
```

### 2ï¸âƒ£ Create Render Service
- Go to https://dashboard.render.com
- Click **"New +"** â†’ **"Web Service"**
- Connect your GitHub repo
- Select: `docs-translator-a2a` directory

### 3ï¸âƒ£ Configure Build Settings

**In Render UI:**
- **Name**: `docs-translator-a2a`
- **Runtime**: **Python 3**
- **Build Command**:
  ```
  pip install --upgrade pip && pip install -r requirements.txt
  ```
- **Start Command**:
  ```
  python src/a2a_server.py
  ```

### 4ï¸âƒ£ Set Environment Variables (IMPORTANT! ğŸ”’)

Click "Environment" tab and add:

| Key | Value | Secret? |
|-----|-------|---------|
| `OPENAI_API_KEY` | `your_actual_openai_key` | âœ… YES |
| `OPENAI_MODEL` | `gpt-4o` | No |
| `A2A_SERVICE_HOST` | `0.0.0.0` | No |
| `A2A_SERVICE_PORT` | `8001` | No |
| `LOG_LEVEL` | `INFO` | No |

**âš ï¸ CRITICAL**: Make sure OPENAI_API_KEY is marked as **secret**

### 5ï¸âƒ£ Deploy
- Click **"Create Web Service"**
- Wait 2-3 minutes â±ï¸
- Check logs for: `ğŸš€ Starting Docs Translator A2A VaaS Service`

---

## âœ… Test Your Deployment

Once live, get your URL: `https://your-service-name.onrender.com`

### Test 1: Health Check
```bash
curl https://your-service-name.onrender.com/health
```

Expected:
```json
{
  "status": "healthy",
  "a2a_enabled": true,
  "openai_configured": true
}
```

### Test 2: Agent Card (A2A Discovery)
```bash
curl https://your-service-name.onrender.com/.well-known/agent-card.json
```

Expected: JSON with agent capabilities

### Test 3: Translation (POST request)
```bash
curl -X POST https://your-service-name.onrender.com/invoke \
  -H "Content-Type: application/json" \
  -d '{
    "capability": "translate_document",
    "parameters": {
      "text": "Hola mundo",
      "source_language": "es",
      "target_language": "en"
    }
  }'
```

---

## ğŸ”— Connect Your Enterprise App

Update your main repo's `.env`:

```bash
# Point to your Render deployment
VENDOR_SERVER_HOST=your-service-name.onrender.com
VENDOR_SERVER_PORT=443  # HTTPS
```

Or hardcode in `tools/vendor_connector.py`:
```python
vendor_url = "https://your-service-name.onrender.com"
```

---

## ğŸ› Common Issues

### "Build failed" or "stuck"
- âœ… **Fixed!** We removed heavy dependencies
- If still failing: Check Render logs for specific error

### "OPENAI_API_KEY not set"
- Go to Render dashboard â†’ Your Service â†’ Environment
- Add `OPENAI_API_KEY` as **secret**
- Click "Save Changes" (this will redeploy)

### Service sleeps (Free tier)
- Free tier sleeps after 15 minutes of inactivity
- **Solution**: Upgrade to Starter tier ($7/month) for always-on
- Or: Use cron job to ping `/health` every 10 minutes

### Agent Card 404
- Check logs: Is server running on port 8001?
- Verify start command: `python src/a2a_server.py`
- Check for startup errors in logs

---

## ğŸ’¡ Pro Tips

1. **Monitor logs** during first deployment
2. **Free tier** is great for testing but sleeps after 15min
3. **Starter tier** ($7/mo) recommended for production
4. **Set usage limits** in OpenAI dashboard to control costs
5. **Health endpoint** is at `/health` (no auth required)

---

## ğŸ“Š Your URLs (Replace with actual service name)

- **Base URL**: `https://your-service-name.onrender.com`
- **Agent Card**: `https://your-service-name.onrender.com/.well-known/agent-card.json`
- **Health**: `https://your-service-name.onrender.com/health`
- **Logs**: Render Dashboard â†’ Your Service â†’ Logs

---

## ğŸ‰ Success Indicators

When deployment succeeds, you'll see in logs:

```
ğŸš€ Starting Docs Translator A2A VaaS Service
================================================================================
   Host: 0.0.0.0
   Port: 8001
   OpenAI Model: gpt-4o

ğŸ“¦ Creating translation agent...
âœ… Agent created successfully

ğŸ”Œ Wrapping agent with A2A protocol (to_a2a)...
âœ… A2A wrapper applied

================================================================================
ğŸ“‹ A2A Endpoints (auto-generated by to_a2a):
================================================================================
   Agent Card:  http://0.0.0.0:8001/.well-known/agent-card.json
   Streams:     http://0.0.0.0:8001/streams
   Health:      http://0.0.0.0:8001/health

ğŸŒ Server ready to accept A2A connections from ADK consumers
```

---

**Questions?** See full guide: [DEPLOYMENT.md](./DEPLOYMENT.md)

**Security concerns?** All secrets are in Render's encrypted environment variables, never in code! ğŸ”’
